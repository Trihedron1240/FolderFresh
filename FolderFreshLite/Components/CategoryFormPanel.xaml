<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="FolderFreshLite.Components.CategoryFormPanel"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:FolderFreshLite.Components"
    xmlns:models="using:FolderFreshLite.Models">

    <!-- Modal Overlay -->
    <Grid Background="#80000000">
        <!-- Centered Form Card -->
        <Border Background="#252525"
                BorderBrush="#333333"
                BorderThickness="1"
                CornerRadius="12"
                MaxWidth="480"
                Margin="24"
                VerticalAlignment="Center"
                HorizontalAlignment="Center">
            <Grid Padding="24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header -->
                <Grid Grid.Row="0" Margin="0,0,0,24">
                    <TextBlock x:Name="HeaderText"
                               Text="New Category"
                               FontSize="20"
                               FontWeight="SemiBold"
                               Foreground="#FFFFFF"
                               VerticalAlignment="Center"/>
                    <Button x:Name="CloseButton"
                            HorizontalAlignment="Right"
                            Background="Transparent"
                            BorderThickness="0"
                            Padding="8"
                            CornerRadius="4"
                            Click="CloseButton_Click">
                        <FontIcon Glyph="&#xE711;"
                                  FontSize="16"
                                  Foreground="#666666"/>
                    </Button>
                </Grid>

                <!-- Form Content -->
                <ScrollViewer Grid.Row="1"
                              VerticalScrollBarVisibility="Auto"
                              VerticalScrollMode="Enabled"
                              HorizontalScrollMode="Disabled"
                              IsVerticalRailEnabled="True">
                    <StackPanel Spacing="20">
                        <!-- Name Row -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Name"
                                       FontSize="12"
                                       Foreground="#999999"/>
                            <TextBox x:Name="NameTextBox"
                                     PlaceholderText="e.g. Invoices, Screenshots"
                                     Background="#2D2D2D"
                                     BorderBrush="#333333"
                                     BorderThickness="1"
                                     CornerRadius="12"
                                     Height="44"
                                     Padding="12,0"
                                     FontSize="14"
                                     Foreground="#FFFFFF"/>
                        </StackPanel>

                        <!-- Icon & Color Row -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Icon Picker -->
                            <StackPanel Grid.Column="0" Spacing="8">
                                <TextBlock Text="Icon"
                                           FontSize="12"
                                           Foreground="#999999"/>
                                <GridView x:Name="IconGrid"
                                          SelectionMode="Single"
                                          SelectionChanged="IconGrid_SelectionChanged"
                                          IsItemClickEnabled="True"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                    <GridView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <ItemsWrapGrid MaximumRowsOrColumns="6"
                                                           Orientation="Horizontal"
                                                           ItemWidth="40"
                                                           ItemHeight="40"/>
                                        </ItemsPanelTemplate>
                                    </GridView.ItemsPanel>
                                    <GridView.ItemContainerStyle>
                                        <Style TargetType="GridViewItem">
                                            <Setter Property="Margin" Value="2"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="MinWidth" Value="36"/>
                                            <Setter Property="MinHeight" Value="36"/>
                                        </Style>
                                    </GridView.ItemContainerStyle>
                                    <GridView.ItemTemplate>
                                        <DataTemplate x:DataType="x:String">
                                            <Border Width="32"
                                                    Height="32"
                                                    CornerRadius="6"
                                                    Background="#333333">
                                                <TextBlock Text="{x:Bind}"
                                                           FontSize="16"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Border>
                                        </DataTemplate>
                                    </GridView.ItemTemplate>
                                </GridView>
                            </StackPanel>

                            <!-- Color Picker -->
                            <StackPanel Grid.Column="2" Spacing="8">
                                <TextBlock Text="Color"
                                           FontSize="12"
                                           Foreground="#999999"/>
                                <GridView x:Name="ColorGrid"
                                          SelectionMode="Single"
                                          SelectionChanged="ColorGrid_SelectionChanged"
                                          IsItemClickEnabled="True"
                                          ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                          ScrollViewer.VerticalScrollBarVisibility="Disabled">
                                    <GridView.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <ItemsWrapGrid MaximumRowsOrColumns="4"
                                                           Orientation="Horizontal"
                                                           ItemWidth="40"
                                                           ItemHeight="40"/>
                                        </ItemsPanelTemplate>
                                    </GridView.ItemsPanel>
                                    <GridView.ItemContainerStyle>
                                        <Style TargetType="GridViewItem">
                                            <Setter Property="Margin" Value="2"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="MinWidth" Value="36"/>
                                            <Setter Property="MinHeight" Value="36"/>
                                        </Style>
                                    </GridView.ItemContainerStyle>
                                </GridView>
                            </StackPanel>
                        </Grid>

                        <!-- Extensions Row -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="File extensions"
                                       FontSize="12"
                                       Foreground="#999999"/>
                            <TextBlock Text="Files with these extensions will be categorized here"
                                       FontSize="11"
                                       Foreground="#666666"/>

                            <!-- Extension Input -->
                            <TextBox x:Name="ExtensionInputBox"
                                     PlaceholderText=".pdf"
                                     Background="#2D2D2D"
                                     BorderBrush="#333333"
                                     BorderThickness="1"
                                     CornerRadius="12"
                                     Height="44"
                                     Padding="12,0"
                                     FontSize="14"
                                     Foreground="#FFFFFF"
                                     KeyDown="ExtensionInputBox_KeyDown"/>

                            <!-- Added Extensions Pills -->
                            <ItemsControl x:Name="ExtensionPillsList">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="6"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="x:String">
                                        <Border Background="#2D2D2D"
                                                CornerRadius="4"
                                                Padding="10,6">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <TextBlock Text="{x:Bind}"
                                                           FontSize="12"
                                                           Foreground="#CCCCCC"
                                                           VerticalAlignment="Center"/>
                                                <Button Background="Transparent"
                                                        BorderThickness="0"
                                                        Padding="0"
                                                        MinWidth="0"
                                                        MinHeight="0"
                                                        Click="RemoveExtension_Click"
                                                        Tag="{x:Bind}">
                                                    <FontIcon Glyph="&#xE711;"
                                                              FontSize="10"
                                                              Foreground="#666666"/>
                                                </Button>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>

                            <!-- Common Suggestions -->
                            <StackPanel Orientation="Horizontal" Spacing="6" Margin="0,4,0,0">
                                <TextBlock Text="Common:"
                                           FontSize="11"
                                           Foreground="#666666"
                                           VerticalAlignment="Center"/>
                                <Button Content=".pdf"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#60CDFF"
                                        FontSize="11"
                                        Padding="4,2"
                                        Click="SuggestionChip_Click"/>
                                <Button Content=".doc"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#60CDFF"
                                        FontSize="11"
                                        Padding="4,2"
                                        Click="SuggestionChip_Click"/>
                                <Button Content=".txt"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#60CDFF"
                                        FontSize="11"
                                        Padding="4,2"
                                        Click="SuggestionChip_Click"/>
                                <Button Content=".jpg"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#60CDFF"
                                        FontSize="11"
                                        Padding="4,2"
                                        Click="SuggestionChip_Click"/>
                                <Button Content=".png"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#60CDFF"
                                        FontSize="11"
                                        Padding="4,2"
                                        Click="SuggestionChip_Click"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Destination Row -->
                        <StackPanel Spacing="8">
                            <TextBlock Text="Move to folder"
                                       FontSize="12"
                                       Foreground="#999999"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBox x:Name="DestinationTextBox"
                                         Grid.Column="0"
                                         PlaceholderText="Documents/Invoices"
                                         Background="#2D2D2D"
                                         BorderBrush="#333333"
                                         BorderThickness="1"
                                         CornerRadius="12"
                                         Height="44"
                                         Padding="12,0"
                                         FontSize="14"
                                         Foreground="#FFFFFF"
                                         Margin="0,0,8,0"/>

                                <Button Grid.Column="1"
                                        Background="#2D2D2D"
                                        BorderBrush="#333333"
                                        BorderThickness="1"
                                        CornerRadius="12"
                                        Height="44"
                                        Width="44"
                                        Padding="0"
                                        Click="BrowseFolder_Click">
                                    <FontIcon Glyph="&#xE8B7;"
                                              FontSize="16"
                                              Foreground="#999999"/>
                                </Button>
                            </Grid>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>

                <!-- Button Row -->
                <Grid Grid.Row="2" Margin="0,24,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button x:Name="CancelButton"
                            Grid.Column="1"
                            Content="Cancel"
                            Background="Transparent"
                            BorderThickness="0"
                            Foreground="#999999"
                            FontSize="14"
                            Padding="16,10"
                            Margin="0,0,8,0"
                            Click="CancelButton_Click"/>

                    <Button x:Name="SaveButton"
                            Grid.Column="2"
                            Content="Save Category"
                            Background="#60CDFF"
                            Foreground="White"
                            FontSize="14"
                            FontWeight="SemiBold"
                            CornerRadius="10"
                            Padding="20,10"
                            Click="SaveButton_Click"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</UserControl>
